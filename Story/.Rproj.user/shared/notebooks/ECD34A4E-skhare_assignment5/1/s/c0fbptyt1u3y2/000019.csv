"0","# Assuming 'bay' is defined somewhere in your code"
"0","vt_income <- get_acs("
"0","  geography = ""county"","
"0","  variables = ""B19013_001"","
"0","  state = ""CA"","
"0","  county = bay,"
"0","  year = 2020,"
"0","  geometry = TRUE"
"0",") %>%"
"0","  mutate(NAME = str_remove(NAME, "" County, California""))"
"2","Getting data from the 2016-2020 5-year ACS
"
"2","Downloading feature geometry from the Census website.  To cache shapefiles for use in future sessions, set `options(tigris_use_cache = TRUE)`.
"
"2","Using FIPS code '06' for state 'CA'
"
"2","Using FIPS code '075' for 'San Francisco County'
"
"2","Using FIPS code '001' for 'Alameda County'
"
"2","Using FIPS code '013' for 'Contra Costa County'
"
"2","Using FIPS code '041' for 'Marin County'
"
"2","Using FIPS code '055' for 'Napa County'
"
"2","Using FIPS code '081' for 'San Mateo County'
"
"2","Using FIPS code '085' for 'Santa Clara County'
"
"2","Using FIPS code '095' for 'Solano County'
"
"2","Using FIPS code '097' for 'Sonoma County'
"
"0","# Choropleth map"
"0","vt_map <- ggplot(vt_income, aes(fill = estimate)) + "
"0","  geom_sf_interactive(aes(data_id = GEOID)) + "
"0","  scale_fill_viridis_c() +  # Use viridis palette"
"0","  theme_void()+"
"0","  guides(fill = ""none"") "
"0",""
"0","# Scatter plot with error bars"
"0","vt_plot <- ggplot(vt_income, aes(x = estimate, y = reorder(NAME, estimate), "
"0","                                 fill = estimate)) +"
"0","  geom_errorbar(aes(xmin = estimate - moe, xmax = estimate + moe)) +"
"0","  geom_point_interactive(color = ""black"", size = 4, shape = 21,"
"0","                         aes(data_id = GEOID)) +"
"0","  scale_fill_viridis_c() +  # Use viridis palette"
"0","  scale_x_continuous(labels = scales::dollar_format()) + "
"0","  labs(title = ""Household income by county in the Bay Area"","
"0","       subtitle = ""2016-2020 American Community Survey"","
"0","       y = """","
"0","       x = ""Median Income (bars represent margin of error)"","
"0","       fill = ""Median Income"") + "
"0","  theme_minimal(base_size = 14)"
"0",""
"0","# Combine the maps"
"0","girafe(ggobj = vt_map + vt_plot, width_svg = 12, height_svg = 5) %>%"
"0","  girafe_options(opts_hover(css = ""fill:cyan;""))"
